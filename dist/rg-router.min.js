"use strict";(function(){var t=[];var e=function a(e){return t.find(function(t){if(t.name==e)return t})};var n=function u(e){return t.find(function(t){if(t.url==e)return t})};var r=function f(t){if(t.state)o.go(t.state.name,true)};var i=function s(t,e){if(typeof history.pushState!="undefined"&&t.history!=false){if(!history.state||history.state.name!=t.name&&!e){var n=t.url?"#/"+t.url:null;history.pushState(t,null,n)}}o.current=t;o.trigger("go",t)};var o={add:function c(n){if(!n||!n.name){throw"Please specify a state name";return}var r=e(n);if(r)r=n;else t.push(n);o.trigger("add")},remove:function d(e){var n=undefined;t=t.filter(function(t){if(t.name!=e)return t;else n=t});o.trigger("remove",n)},go:function v(t,n){if(!o.active||!t)return;var r=e(t);if(!r){throw"State '"+t+"' has not been configured";return}var a=t.split(".");a=a.map(function(t,e){if(e>0){return a.slice(0,e).join(".")+"."+t}else{return t}});a.forEach(function(t,n){if(n<a.length){var i=e(t);r=Object.assign({},r,i)}});if(typeof r.resolve=="function"){var u=r.resolve();if(typeof u.then=="function")u.then(function(){return i(r,n)})}else{i(r,n)}},start:function l(){if(window.location.hash){var t=n(window.location.hash.replace("#/",""));if(t)o.go(t.name)}window.addEventListener("popstate",r);o.active=true;o.trigger("start")},stop:function g(){window.addEventListener("popstate",r);o.active=false;o.trigger("stop")},current:undefined,active:true};riot.observable(o);riot.mixin("rg.router",{init:function h(){this.router.on("go",this.update)},router:o});if(!window.rg)window.rg={};window.rg.router=o})();