"use strict";(function(){var t=[];var e={add:function a(r){if(!r||!r.name){throw"Please specify a state name";return}var i=n(r);if(i)i=r;else t.push(r);e.trigger("add",i)},remove:function u(n){var r=undefined;t=t.filter(function(t){if(t.name!=n)return t;else r=t});e.trigger("remove",r)},go:function f(t,r){if(!e.active||!t)return;var i=n(t);if(!i){throw"State '"+t+"' has not been configured";return}var a=t.split(".");a=a.map(function(t,e){if(e>0){return a.slice(0,e).join(".")+"."+t}else{return t}});a.forEach(function(t,e){if(e<a.length){var r=n(t);i=Object.assign({},i,r)}});if(typeof i.resolve=="function"){var u=i.resolve();if(typeof u.then=="function")u.then(function(){return o(i,r)})}else{o(i,r)}},start:function s(){e.active=true;if(window.location.hash){var t=r(window.location.hash.replace("#!/",""));if(t)e.go(t.name)}window.addEventListener("popstate",i);e.trigger("start")},stop:function c(){e.active=false;window.removeEventListener("popstate",i);e.trigger("stop")},current:undefined,active:false};function n(e){return t.find(function(t){return t.name==e})}function r(e){return t.find(function(t){return t.url==e})}function i(t){if(t.state)e.go(t.state,true)}function o(t,n){if(typeof history.pushState!="undefined"&&t.history!=false){if(!history.state||history.state.name!=t.name&&!n){var r=t.hasOwnProperty("url")?"#!/"+t.url:null;history.pushState(t.name,null,r)}}var i=e.current;e.current=t;e.trigger("go",t,i)}riot.observable(e);riot.mixin("rg.router",{init:function l(){var t=this;this.router.on("go",function(){return t.update()})},router:e});if(!window.rg)window.rg={};window.rg.router=e})();